<!DOCTYPE html>

<html lang="ru">

<head>

  <meta charset="UTF-8" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  

  <style>
    .qty-btn {
  font-size: 18px;
  padding: 2px 0;
  margin: 0;
  background: #28a745;
  color: #fff;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  vertical-align: middle;
  transition: background 0.2s;
}
.qty-btn:hover {
  background: #218838;
}


body.modal-open {
  overflow: hidden;           /* Запретить прокрутку */
  pointer-events: none;       /* Запретить клики по всему body */
}
#previewBlock {
  pointer-events: auto !important; /* Разрешить клики по модальному окну */
}

 button.delete-item {
  background: none; /* Убираем фон */
  border: none; /* Убираем границу */
  color: #dc3545; /* Красный цвет для кнопки */
  font-size: 14px; /* Размер текста */
  cursor: pointer; /* Указываем, что это кнопка */
  padding: 0; /* Убираем лишние внутренние отступы */
  width: 20px; /* Устанавливаем фиксированную ширину */
  height: 20px; /* Устанавливаем фиксированную высоту */
  border-radius: 20%; /* Делаем кнопку круглой */
  line-height: 1; /* Убираем лишние отступы внутри кнопки */
  display: flex; /* Центрируем содержимое */
  align-items: center;
  justify-content: center;
}

button.delete-item:hover {
  color: #c82333; /* Более тёмный красный при наведении */
}

    body {

  background-image: url('фон.avif'); /* сюда вставь ссылку или путь к картинке */

  background-size: cover;

  background-repeat: no-repeat;

  background-position: center center;

}



    * { box-sizing: border-box; margin: 0; padding: 0; }

    body { font-family: 'Arial', sans-serif; background: #f4f4f4; color: #333; }

    h1, h2 { text-align: center; margin-bottom: 20px; animation: fadeIn 1s ease forwards; }

    body {

  background-image: url('фон.avif'); /* сюда вставь ссылку или путь к картинке */

  background-size: cover;

  background-repeat: no-repeat;

  background-position: center center;

}

h1 {

  color: rgb(255, 255, 255);

}





    input, select, button, textarea {

      font-size: 1rem;

      padding: 10px;

      margin: 10px auto;

      width: 100%;

      max-width: 400px;

      display: block;

      border-radius: 5px;

      border: 1px solid #ccc;

    }

    .cart-item {

  display: flex;

  align-items: center;

  justify-content: space-between;

  margin-bottom: 10px;

}



    button {

      background: #28a745;

      color: white;

      border: none;

      cursor: pointer;

      transition: 0.3s;

    }

    button:hover { background: #218838; }



    table {

      width: 100%;

      border-collapse: collapse;

      margin-bottom: 20px;

      background: white;

      box-shadow: 0 0 10px #ccc;

    }

    th, td {

      padding: 10px;

      border: 1px solid #ddd;

      text-align: center;

    }

    th { background: #f8f8f8; }



    .product-img { max-width: 60px; height: auto; transition: transform 0.3s ease; }

    .product-img:hover { transform: scale(1.1); }



    .cart-summary { text-align: center; font-weight: bold; margin: 10px 0; }

    .order-form, #orderHistory { background: white; padding: 20px; border-radius: 8px; box-shadow: 0 0 10px #ccc; margin-top: 20px; }



    .delete-order {

      background: #dc3545;

      color: white;

      border: none;

      padding: 8px 12px;

      margin-top: 10px;

      border-radius: 5px;

      cursor: pointer;

      transition: background 0.3s ease;

    }

    .delete-order:hover {

      background: #c82333;

    }



    @keyframes fadeIn {

      from { opacity: 0; transform: translateY(20px); }

      to { opacity: 1; transform: translateY(0); }

    }



    /* Новая анимация для добавления в корзину */

    @keyframes addToCart {

      0% { transform: scale(1); background-color: #28a745; }

      50% { transform: scale(1.2); background-color: #218838; }

      100% { transform: scale(1); background-color: #28a745; }

    }

    .animate-add {

      animation: addToCart 0.5s ease;

    }



    @media (max-width: 600px) {

      th, td { font-size: 12px; padding: 6px; }

      input, select, button, textarea { font-size: 0.9rem; padding: 8px; }

      .cart-summary { font-size: 1.2rem; }

      #cartList div { font-size: 0.9rem; }

      .order-form input, .order-form button { width: 90%; }

    }
    @media (max-width: 600px) {
  button.delete-item {
    width: 20px; /* Устанавливаем фиксированную ширину */
    height: 20px; /* Устанавливаем фиксированную высоту */
    font-size: 12px; /* Уменьшаем размер текста */
    padding: 0; /* Убираем лишние отступы */
  }
}

  </style>
      



  <!-- SweetAlert2 -->

  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

</head>

<body>

  <!-- Блок для просмотра фото -->
  <div id="previewBlock" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; z-index:1000; pointer-events:auto;">
    <div id="previewInner" style="position:absolute; top:10%; left:50%; transform:translateX(-50%); background:white; padding:20px; border-radius:10px; box-shadow:0 0 20px #0008;">
      <span id="closePreview" style="cursor:pointer; float:right; font-size:24px;">&times;</span>
      <img id="previewImg" src="" alt="Просмотр" style="max-width:90vw; max-height:70vh; display:block; margin:auto;">
    </div>
  </div>
<!-- filepath: c:\Users\hp\Desktop\нож\index.html -->

  <h1>Мелочь - Каталог товаров</h1>



  <input type="text" id="search" placeholder="Поиск товара..." />

  <select id="sort">

    <option value="">Сортировка по цене</option>

    <option value="asc">Сначала дешёвые</option>

    <option value="desc">Сначала дорогие</option>

  </select>



  <table>

    <thead>
      <tr>
        <th>№</th>
        <th>Фото</th>
        <th>Название</th>
        <th>Цена</th>
        <th>Кол-во</th>
        <th>Добавить</th>
      </tr>
    </thead>

    <tbody id="productTable"></tbody>

  </table>



  <div class="order-form">

    <h2>Оформить заказ</h2>

    <div id="cartList"></div>

    <div class="cart-summary">Итого: <span id="totalSum">0</span> с</div>

    <button id="clearCart">Очистить корзину</button>

    <input type="text" id="name" placeholder="Ваше имя" required />

    <input type="tel" id="phone" placeholder="Телефон" required />

    <input type="text" id="address" placeholder="Адрес доставки" required />

    <button id="submitOrder">Отправить заказ</button>

  </div>



  <button id="toggleHistory">История заказов</button>

  <div id="orderHistory" style="display:none">

    <h2>История заказов</h2>

    <ul id="historyList"></ul>

  </div>



  <script>
const products = [
      
 {id: 1, title: '36*15 (84шт кар)', price: 12, optPrice: 10, optQty: 84, minQty: 7, image: 'фото4лик/3515.jpg' },
 {id: 2, title: '40*30', price: 20, optPrice: 16, optQty: 72,minQty: 6, image: 'фото4лик/4030.jpg' },
{id: 3, title: '40*50', price: 30, optPrice: 25, optQty: 52,minQty: 6, image: '' },
{id: 4, title: '40*75', price: 40, optPrice: 35, optQty: 72,minQty: 6, image: 'фото4лик/4075.jpg' },
{id: 5, title: '40*100', price: 50, optPrice: 45, optQty: 54,minQty: 6, image: 'фото4лик/40100.jpg' },
{id: 6, title: '40*150', price: 65, optPrice: 60, optQty: 48,minQty: 6, image: 'фото4лик/40150.jpg' },
{id: 7, title: '40*200', price: 85, optPrice: 80, optQty: 36,minQty: 6, image: 'фото4лик/40200.jpg' },
{id: 8, title: '40*250', price: 110, optPrice: 100, optQty: 36,minQty: 6, image: '' },
{id: 9, title: '40*300', price: 150, optPrice: 130, optQty: 30,minQty: 6, image: 'фото4лик/40300.jpg' },
{id: 10, title: '40*400*24шт/кар', price: 220, optPrice: 200, optQty: 24,minQty: 6, image: 'фото4лик/40400.jpg' },
{id: 11, title: '45*30', price: 25, optPrice: 20, optQty: 60,minQty: 5, image: '' },
{id: 12, title: '45*50', price: 35, optPrice: 30, optQty: 60,minQty: 5, image: '' },
{id: 13, title: '45*75', price: 45, optPrice: 40, optQty: 60,minQty: 5, image: '' },
{id: 14, title: '45*100', price: 55, optPrice: 50, optQty: 45,minQty: 5, image: '' },
{id: 15, title: '45*150', price: 70, optPrice: 65, optQty: 40,minQty: 5, image: '' },
{id: 16, title: '', price: 0, optPrice: 0, optQty: 0, image: '' },
{id: 17, title: '', price: 0, optPrice: 0, optQty: 0, image: '' },
{id: 18, title: '', price: 0, optPrice: 0, optQty: 0, image: '' },
{id: 19, title: '', price: 0, optPrice: 0, optQty: 0, image: '' },
{id: 20, title: '', price: 0, optPrice: 0, optQty: 0, image: '' },
{id: 21, title: '', price: 0, optPrice: 0, optQty: 0, image: '' },
{id: 22, title: '', price: 0, optPrice: 0, optQty: 0, image: '' },
{id: 23, title: '', price: 0, optPrice: 0, optQty: 0, image: '' },
{id: 24, title: '', price: 0, optPrice: 0, optQty: 0, image: '' },
{id: 25, title: '', price: 0, optPrice: 0, optQty: 0, image: '' },
{id: 26, title: '', price: 0, optPrice: 0, optQty: 0, image: '' },
{id: 27, title: '', price: 0, optPrice: 0, optQty: 0, image: '' },
{id: 28, title: '', price: 0, optPrice: 0, optQty: 0, image: '' },
{id: 29, title: '', price: 0, optPrice: 0, optQty: 0, image: '' },
{id: 30, title: '', price: 0, optPrice: 0, optQty: 0, image: '' },
{id: 31, title: '', price: 0, optPrice: 0, optQty: 0, image: '' },
{id: 32, title: '', price: 0, optPrice: 0, optQty: 0, image: '' },
{id: 33, title: '', price: 0, optPrice: 0, optQty: 0, image: '' },
{id: 34, title: '', price: 0, optPrice: 0, optQty: 0, image: '' },
{id: 35, title: '', price: 0, optPrice: 0, optQty: 0, image: '' },
{id: 36, title: '', price: 0, optPrice: 0, optQty: 0, image: '' },
{id: 37, title: '', price: 0, optPrice: 0, optQty: 0, image: '' },
{id: 38, title: '', price: 0, optPrice: 0, optQty: 0, image: '' },
{id: 39, title: '', price: 0, optPrice: 0, optQty: 0, image: '' },
{id: 40, title: '', price: 0, optPrice: 0, optQty: 0, image: '' },
{id: 41, title: '', price: 0, optPrice: 0, optQty: 0, image: '' },
{id: 42, title: '', price: 0, optPrice: 0, optQty: 0, image: '' },
{id: 43, title: '', price: 0, optPrice: 0, optQty: 0, image: '' },
{id: 44, title: '', price: 0, optPrice: 0, optQty: 0, image: '' },
{id: 45, title: '', price: 0, optPrice: 0, optQty: 0, image: '' },
{id: 46, title: '', price: 0, optPrice: 0, optQty: 0, image: '' },
{id: 47, title: '', price: 0, optPrice: 0, optQty: 0, image: '' },
{id: 48, title: '', price: 0, optPrice: 0, optQty: 0, image: '' },
{id: 49, title: '', price: 0, optPrice: 0, optQty: 0, image: '' },
{id: 50, title: '', price: 0, optPrice: 0, optQty: 0, image: '' },
{id: 51, title: '', price: 0, optPrice: 0, optQty: 0, image: '' },
{id: 52, title: '', price: 0, optPrice: 0, optQty: 0, image: '' },
{id: 53, title: '', price: 0, optPrice: 0, optQty: 0, image: '' },
{id: 54, title: '', price: 0, optPrice: 0, optQty: 0, image: '' },
{id: 55, title: '', price: 0, optPrice: 0, optQty: 0, image: '' },
{id: 56, title: '', price: 0, optPrice: 0, optQty: 0, image: '' },
{id: 57, title: '', price: 0, optPrice: 0, optQty: 0, image: '' },
{id: 58, title: '', price: 0, optPrice: 0, optQty: 0, image: '' },
{id: 59, title: '', price: 0, optPrice: 0, optQty: 0, image: '' },
{id: 60, title: '', price: 0, optPrice: 0, optQty: 0, image: '' },
{id: 61, title: '', price: 0, optPrice: 0, optQty: 0, image: '' },
{id: 62, title: '', price: 0, optPrice: 0, optQty: 0, image: '' },
{id: 63, title: '', price: 0, optPrice: 0, optQty: 0, image: '' },
{id: 64, title: '', price: 0, optPrice: 0, optQty: 0, image: '' },
{id: 65, title: '', price: 0, optPrice: 0, optQty: 0, image: '' },
{id: 66, title: '', price: 0, optPrice: 0, optQty: 0, image: '' },
{id: 67, title: '', price: 0, optPrice: 0, optQty: 0, image: '' },
{id: 68, title: '', price: 0, optPrice: 0, optQty: 0, image: '' },
{id: 69, title: '', price: 0, optPrice: 0, optQty: 0, image: '' },
{id: 70, title: '', price: 0, optPrice: 0, optQty: 0, image: '' },
{id: 71, title: '', price: 0, optPrice: 0, optQty: 0, image: '' },
{id: 72, title: '', price: 0, optPrice: 0, optQty: 0, image: '' },
{id: 73, title: '', price: 0, optPrice: 0, optQty: 0, image: '' },
{id: 74, title: '', price: 0, optPrice: 0, optQty: 0, image: '' },
{id: 75, title: '', price: 0, optPrice: 0, optQty: 0, image: '' },
{id: 76, title: '', price: 0, optPrice: 0, optQty: 0, image: '' },
{id: 77, title: '', price: 0, optPrice: 0, optQty: 0, image: '' },
{id: 78, title: '', price: 0, optPrice: 0, optQty: 0, image: '' },
{id: 79, title: '', price: 0, optPrice: 0, optQty: 0, image: '' },
{id: 80, title: '', price: 0, optPrice: 0, optQty: 0, image: '' },
{id: 81, title: '', price: 0, optPrice: 0, optQty: 0, image: '' },
{id: 82, title: '', price: 0, optPrice: 0, optQty: 0, image: '' },
{id: 83, title: '', price: 0, optPrice: 0, optQty: 0, image: '' },
{id: 84, title: '', price: 0, optPrice: 0, optQty: 0, image: '' },
{id: 85, title: '', price: 0, optPrice: 0, optQty: 0, image: '' },
{id: 86, title: '', price: 0, optPrice: 0, optQty: 0, image: '' },
{id: 87, title: '', price: 0, optPrice: 0, optQty: 0, image: '' },
{id: 88, title: '', price: 0, optPrice: 0, optQty: 0, image: '' },
{id: 89, title: '', price: 0, optPrice: 0, optQty: 0, image: '' },
{id: 90, title: '', price: 0, optPrice: 0, optQty: 0, image: '' },
{id: 91, title: '', price: 0, optPrice: 0, optQty: 0, image: '' },
{id: 92, title: '', price: 0, optPrice: 0, optQty: 0, image: '' },
{id: 93, title: '', price: 0, optPrice: 0, optQty: 0, image: '' },
{id: 94, title: '', price: 0, optPrice: 0, optQty: 0, image: '' },
{id: 95, title: '', price: 0, optPrice: 0, optQty: 0, image: '' },
{id: 96, title: '', price: 0, optPrice: 0, optQty: 0, image: '' },
{id: 97, title: '', price: 0, optPrice: 0, optQty: 0, image: '' },
{id: 98, title: '', price: 0, optPrice: 0, optQty: 0, image: '' },
{id: 99, title: '', price: 0, optPrice: 0, optQty: 0, image: '' },
{id: 100, title: '', price: 0, optPrice: 0, optQty: 0, image: '' },
     
    ];



    const cart = JSON.parse(localStorage.getItem('cart')) || [];



    const productTable = document.getElementById('productTable');

    const search = document.getElementById('search');

    const sort = document.getElementById('sort');

    const cartList = document.getElementById('cartList');

    const totalSum = document.getElementById('totalSum');


// ...existing code...
function renderProducts() {
  let filtered = products.filter(p => p.title?.trim() && p.image?.trim());
  if (search.value) {
    filtered = filtered.filter(p => p.title.toLowerCase().includes(search.value.toLowerCase()));
  }
  if (sort.value) {
    filtered.sort((a, b) => sort.value === 'asc' ? a.price - b.price : b.price - a.price);
  }
  productTable.innerHTML = '';
  filtered.forEach((p, idx) => {
  const min = p.minQty || 1;
  const row = document.createElement('tr');
  row.innerHTML = `
    <td>${idx + 1}</td>
    <td><img src="${p.image}" class="product-img" alt="${p.title}" style="cursor:pointer;" onclick="showPreview('${p.image}')"/></td>
    <td>${p.title}</td>
    <td class="price-cell">${p.price}</td>
    <td>
  <div style="display:flex; flex-direction:column; align-items:center;">
<input type="number" min="${min}" step="${min}" value="${min}" data-id="${p.id}" readonly style="width:70px;display:block;text-align:center;margin-bottom:4px;" />    <div>
      <button type="button" class="qty-btn" onclick="changeQty(this, -${min})" style="width:32px;display:inline-block;">−</button>
      <button type="button" class="qty-btn" onclick="changeQty(this, ${min})" style="width:32px;display:inline-block;">+</button>
    </div>
  </div>
</td>
    <td><button onclick="addToCart(${p.id}, '${p.title}', ${p.price}, '${p.image}', this)">добавить</button></td>
  `;
  productTable.appendChild(row);

  // Обработчик изменения количества
  const qtyInput = row.querySelector('input[type="number"]');
  qtyInput.oninput = function() {
    const priceCell = row.querySelector('.price-cell');
    let price = p.price;
    if (p.optPrice && p.optQty && +this.value >= p.optQty) price = p.optPrice;
    priceCell.textContent = price;
    // Обновляем кнопку, чтобы она передавала новую цену
    const addBtn = row.querySelector('button');
    addBtn.setAttribute('onclick', `addToCart(${p.id}, '${p.title}', ${price}, '${p.image}', this)`);
  };
});
}
// ...existing code...
   


function addToCart(id, title, price, image, btn) {
  const qty = +btn.parentElement.parentElement.querySelector('input').value;
  const product = products.find(p => p.id === id);
  const minQty = product.minQty || 1;
  if (qty < minQty || qty % minQty !== 0) {
    Swal.fire('Ошибка', `Можно добавить только кратно ${minQty} шт.`, 'warning');
    return;
  }
  const index = cart.findIndex(item => item.id === id);
  if (index !== -1) cart[index].qty += qty;
  else cart.push({ id, title, price, qty });
  updateCart();

  // Анимация кнопки
  btn.classList.add('animate-add');
  setTimeout(() => btn.classList.remove('animate-add'), 500);

  // Показываем уведомление
  Swal.fire({
    title: 'Товар добавлен в корзину!',
    text: `${title} × ${qty} был добавлен в вашу корзину.`,
    icon: 'success',
    confirmButtonText: 'Ок',
    position: 'bottom',
    showConfirmButton: true,
    timer: 1500,
    padding: '10px',
    toast: true
  });

  // Сохраняем корзину в localStorage
  localStorage.setItem('cart', JSON.stringify(cart));
}





    function updateCart() {

  cartList.innerHTML = '';

  let total = 0;

  cart.forEach((item, i) => {

    total += item.qty * item.price;

    const div = document.createElement('div');

    div.classList.add('cart-item');

    div.innerHTML = `
  <span style="flex-grow:1;">${item.title} — ${item.qty} × ${item.price}c = ${item.qty * item.price}c</span>
  <button class="delete-item" onclick="removeFromCart(${i})">&times;</button>
`;

    cartList.appendChild(div);

  });

  totalSum.textContent = total;



  // Проверка на пустоту корзины

  const clearCartButton = document.getElementById('clearCart');

  if (cart.length === 0) {

    clearCartButton.style.display = 'none'; // скрыть кнопку, если корзина пуста

  } else {

    clearCartButton.style.display = 'block'; // показать кнопку, если корзина не пуста

  }



  // Сохраняем корзину в localStorage

  localStorage.setItem('cart', JSON.stringify(cart));

}





    function removeFromCart(i) {

      cart.splice(i, 1);

      updateCart();

    }



    document.getElementById('submitOrder').onclick = () => {

  const name = document.getElementById('name').value.trim();

  const phone = document.getElementById('phone').value.trim();

  const address = document.getElementById('address').value.trim();

  if (!name || !phone || !address || cart.length === 0) {

    Swal.fire('Ошибка', 'Заполните все поля и добавьте товары', 'warning');

    return;

  }
  const items = cart.map(i => `${i.title} — ${i.qty}×${i.price}c=${i.qty * i.price}`).join('\n');

const total = cart.reduce((sum, item) => sum + item.qty * item.price, 0);

const msg = `Новый заказ:
Имя: ${name}
Телефон: ${phone}
Адрес: ${address}
Товары:
${items}

Итого: ${total}c`;
  

  fetch('https://api.telegram.org/bot7960727448:AAF0B2mizrzj7sjHP68n-1IcjLoNc6kwVkE/sendMessage', {

    method: 'POST',

    headers: { 'Content-Type': 'application/json' },

    body: JSON.stringify({ chat_id: '5567924440', text: msg })

  }).then(r => {

    if (r.ok) {

      Swal.fire('Успех!', 'Ваш заказ отправлен!', 'success');

      cart.length = 0;

      updateCart();

      localStorage.removeItem('cart');

      document.getElementById('name').value = '';

      document.getElementById('phone').value = '';

      document.getElementById('address').value = '';

    } else {

      Swal.fire('Ошибка', 'Не удалось отправить заказ. Попробуйте позже.', 'error');

    }

  }).catch(error => {

    console.error(error);

    Swal.fire('Ошибка', 'Не удалось отправить заказ. Проверьте подключение к интернету.', 'error');

  });

};

document.getElementById('clearCart').onclick = () => {

  cart.length = 0; // очищаем массив корзины

  updateCart();    // обновляем отображение

  localStorage.removeItem('cart'); // убираем данные из localStorage

  Swal.fire('Корзина очищена!', '', 'success'); // показываем уведомление

};





      const items = cart.map(i => `${i.title} — ${i.qty}×${i.price}c`).join('\n');

      const total = cart.reduce((sum, item) => sum + item.qty * item.price, 0);



      const msg = `Новый заказ:

Имя: ${name}

Телефон: ${phone}

Адрес: ${address}

Товары:

${items}



Итого: ${total}c`;



      fetch('https://api.telegram.org/bot<ТВОЙ_ТОКЕН>/sendMessage', {

        method: 'POST',

        headers: { 'Content-Type': 'application/json' },

        body: JSON.stringify({ chat_id: '<ТВОЙ_CHAT_ID>', text: msg })

      }).then(r => {

        if (r.ok) {

          Swal.fire('Успех!', 'Ваш заказ отправлен!', 'success');

          cart.length = 0;

          updateCart();

          localStorage.removeItem('cart');

          document.getElementById('name').value = '';

          document.getElementById('phone').value = '';

          document.getElementById('address').value = '';

        } else {

          Swal.fire('Ошибка', 'Не удалось отправить заказ. Попробуйте позже.', 'error');

        }

      });

    ;



    function deleteOrder(index) {

      let history = JSON.parse(localStorage.getItem('orderHistory') || '[]');

      history.splice(index, 1);

      localStorage.setItem('orderHistory', JSON.stringify(history));

      document.getElementById('toggleHistory').click();

      document.getElementById('toggleHistory').click();

    }



    document.getElementById('toggleHistory').onclick = () => {

  const hist = document.getElementById('orderHistory');

  hist.style.display = hist.style.display === 'none' ? 'block' : 'none';



  const history = JSON.parse(localStorage.getItem('orderHistory') || '[]');

  const list = document.getElementById('historyList');

  list.innerHTML = '';



  if (history.length === 0) {

    list.innerHTML = '<li>История заказов пуста.</li>';

    document.getElementById('toggleHistory').style.display = 'none'; // Скрыть кнопку, если нет заказов

    return;

  }





  // Показать кнопку только если есть заказы

  document.getElementById('toggleHistory').style.display = history.length === 0 ? 'none' : 'block';

};





    search.oninput = renderProducts;

    sort.onchange = renderProducts;

    renderProducts();

    updateCart();
    function showPreview(src) {
  document.getElementById('previewImg').src = src;
  document.getElementById('previewBlock').style.display = 'block';
  document.body.classList.add('modal-open');
}

document.getElementById('closePreview').onclick = function() {
  document.getElementById('previewBlock').style.display = 'none';
  document.body.classList.remove('modal-open');
};

document.getElementById('previewBlock').onclick = function(e) {
  if (e.target === this) {
    this.style.display = 'none';
    document.body.classList.remove('modal-open');
  }
};



function changeQty(btn, delta) {
  // Найти input в той же строке таблицы
  const row = btn.closest('tr');
  const input = row.querySelector('input[type="number"]');
  const min = +input.min;
  let value = +input.value + delta;
  if (value < min) value = min;
  input.value = value;

  // Обновить цену при изменении количества
  const priceCell = row.querySelector('.price-cell');
  const id = +input.dataset.id;
  const product = products.find(p => p.id === id);
  let price = product.price;
  if (product.optPrice && product.optQty && value >= product.optQty) price = product.optPrice;
  priceCell.textContent = price;
  const addBtn = row.querySelector('button[onclick^="addToCart"]');
  addBtn.setAttribute('onclick', `addToCart(${id}, '${product.title}', ${price}, '${product.image}', this)`);
}
  </script>

</body>

</html>
